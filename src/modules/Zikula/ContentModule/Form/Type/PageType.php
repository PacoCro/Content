<?php
/**
 * Content.
 *
 * @copyright Axel Guckelsberger (Zikula)
 * @license http://www.gnu.org/licenses/lgpl.html GNU Lesser General Public License
 * @author Axel Guckelsberger <info@ziku.la>.
 * @link https://ziku.la
 * @version Generated by ModuleStudio 1.3.2 (https://modulestudio.de).
 */

namespace Zikula\ContentModule\Form\Type;

use Symfony\Component\Form\FormBuilderInterface;
use Zikula\ContentModule\Form\Type\Base\AbstractPageType;

/**
 * Page editing form type implementation class.
 */
class PageType extends AbstractPageType
{
    /**
     * @inheritDoc
     */
    public function buildForm(FormBuilderInterface $builder, array $options)
    {
        parent::buildForm($builder, $options);

        $builder->remove('layout');
        $builder->remove('views');

        if ('create' != $options['mode']) {
            $removeFields = [];
            if (!$this->variableApi->get('ZikulaContentModule', 'enableOptionalString1', false)) {
                $removeFields[] = 'optionalString1';
            }
            if (!$this->variableApi->get('ZikulaContentModule', 'enableOptionalString2', false)) {
                $removeFields[] = 'optionalString2';
            }
            if (!$this->variableApi->get('ZikulaContentModule', 'enableOptionalText', false)) {
                $removeFields[] = 'optionalText';
            }
            foreach ($removeFields as $fieldName) {
                $builder->remove($fieldName);
            }
            return;
        }

        // remove detail fields which are only required for editing, but not for creation

        $removeFields = [
            'metaDescription',
            'optionalString1',
            'optionalString2',
            'optionalText',

            'showTitle',
            'skipUiHookSubscriber',
            'skipFilterHookSubscriber',
            'active',
            'activeFrom',
            'activeTo',
            'inMenu',
            'versionData',
            'categories'
        ];
        foreach ($removeFields as $fieldName) {
            $builder->remove($fieldName);
        }
        if ($options['has_moderate_permission'] && !$options['inline_usage']) {
            $builder->remove('moderationSpecificCreator');
            $builder->remove('moderationSpecificCreationDate');
        }
    }
}
