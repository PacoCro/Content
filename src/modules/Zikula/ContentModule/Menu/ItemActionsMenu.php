<?php
/**
 * Content.
 *
 * @copyright Axel Guckelsberger (Zikula)
 * @license http://www.gnu.org/licenses/lgpl.html GNU Lesser General Public License
 * @author Axel Guckelsberger <info@ziku.la>.
 * @link https://ziku.la
 * @version Generated by ModuleStudio 1.3.2 (https://modulestudio.de).
 */

namespace Zikula\ContentModule\Menu;

use Knp\Menu\FactoryInterface;
use Zikula\ContentModule\Entity\PageEntity;
use Zikula\ContentModule\Menu\Base\AbstractItemActionsMenu;

/**
 * This is the item actions menu implementation class.
 */
class ItemActionsMenu extends AbstractItemActionsMenu
{
    /**
     * @inheritDoc
     */
    public function menu(FactoryInterface $factory, array $options = [])
    {
        $menu = parent::menu($factory, $options);
        if (!isset($options['entity']) || !isset($options['area']) || !isset($options['context'])) {
            return $menu;
        }

        $entity = $options['entity'];
        if (!($entity instanceof PageEntity)) {
            return $menu;
        }

        $permissionHelper = $this->container->get('zikula_content_module.permission_helper');
        if ($permissionHelper->mayManagePageContent($entity)) {
            $routePrefix = 'zikulacontentmodule_page_';
            $routeArea = $options['area'];
            $context = $options['context'];
            $title = $this->__('Manage content', 'zikulacontentmodule');
            $menu->addChild($title, [
                'route' => $routePrefix . $routeArea . 'managecontent',
                'routeParameters' => $entity->createUrlArgs()
            ]);
            $menu[$title]->setLinkAttribute('title', $this->__('Manage content elements of page', 'zikulacontentmodule'));
            if ($context == 'display') {
                $menu[$title]->setLinkAttribute('class', 'btn btn-sm btn-default');
            }
            $menu[$title]->setAttribute('icon', 'fa fa-cubes');
        }

        return $menu;
    }
}
