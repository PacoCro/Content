<?php
/**
 * Content.
 *
 * @copyright Axel Guckelsberger (Zikula)
 * @license http://www.gnu.org/licenses/lgpl.html GNU Lesser General Public License
 * @author Axel Guckelsberger <info@ziku.la>.
 * @link https://ziku.la
 * @version Generated by ModuleStudio 1.3.2 (https://modulestudio.de).
 */

namespace Zikula\ContentModule\Helper;

use Doctrine\ORM\QueryBuilder;
use Zikula\ContentModule\Helper\Base\AbstractCollectionFilterHelper;

/**
 * Entity collection filter helper implementation class.
 */
class CollectionFilterHelper extends AbstractCollectionFilterHelper
{
    /**
     * @inheritDoc
     */
    protected function applyDefaultFiltersForPage(QueryBuilder $qb, array $parameters = [])
    {
        $qb = parent::applyDefaultFiltersForPage($qb, $parameters);

        if (null === $this->request) {
            return $qb;
        }
        $routeName = $this->request->get('_route');
        $isAdminArea = false !== strpos($routeName, 'zikulacontentmodule_page_admin');
        if ($isAdminArea/* || $this->permissionHelper->hasComponentPermission('page', ACCESS_ADD)*/) {
            return $qb;
        }

        $qb->andWhere('tbl.active = 1');

        return $qb;
    }

    /**
     * @inheritDoc
     */
    protected function applyDefaultFiltersForContentItem(QueryBuilder $qb, array $parameters = [])
    {
        $qb = parent::applyDefaultFiltersForContentItem($qb, $parameters);

        if (null === $this->request) {
            return $qb;
        }
        $routeName = $this->request->get('_route');
        $isAdminArea = false !== strpos($routeName, 'zikulacontentmodule_page_admin');
        if ($isAdminArea/* || $this->permissionHelper->hasComponentPermission('page', ACCESS_ADD)*/) {
            return $qb;
        }

        $qb->andWhere('tbl.active = 1');

        return $qb;
    }
}
